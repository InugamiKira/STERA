{
    "书源样式整理": [
        "class=\"[^\"\\n]*?\"",
        {
            "转换模板样式": {
                "([^\"\\s]*(?:font-\\d{2,}em|font-\\d{4,}per|solid|dotted|double|dashed|indent|start-|end-|float|inverse|bg-|display|break|wrap)[^\"\\s]*)": "@\\1",
                "bold": "@bold",
                "line-through": "@del",
                "italic": "@ita",
                "em-line[^\"\\s]*": "@un",
                "(?:em-sesame|em-dot|em-circle|em-double-cirlce|em-triangle)[^\"\\s]*": "@dot",
                "[^\"\\s]*align-(?:start|left)": "@left",
                "[^\"\\s]*align-center": "@center",
                "[^\"\\s]*align-(?:end|right)": "@right",
                "gfont(?!\\d)": "@int",
                "gfont([1-9]+)0*": "@int @em1\\1",
                "gfont0([1-9]+)0*": "@int @em0\\1",
                "font-(?:(\\d)em(\\d+?)0*|(\\d{2,}?)0*per)": "@em\\1\\2\\3",
                "font-(\\d)em": "@em\\g<1>0",
                "kogaki": "@em08",
                "color-([A-z\\d-]+)": "@\\1"
            },
            "清除多余样式": {
                "(?<=[\\s\"])[^@\"\\s]+?(?=[\\s\"])": "",
                "^(.*?)@": "type=\"check\" \\1",
                "(?:(?<=\")\\s+|\\s+(?=\")|\\s{2,}|@)": ""
            }
        }
    ],
    "标签规范": [
        "(?s)<page.*?/page>",
        {
            "标签规范化": {
                "^(<page.*?>)[\\s\\S]*?<body(?:(?!ctt)[^>/\\n])*?>": "\\1\\n<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"no\"?>\\n<!DOCTYPE html>\\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"zh\" xmlns:epub=\"http://www.idpf.org/2007/ops\" xmlns:xml=\"http://www.w3.org/XML/1998/namespace\">\\n<head>\\n<title></title>\\n<link href=\"../Styles/stylesheet.css\" type=\"text/css\" rel=\"stylesheet\"/>\\n<script type=\"text/javascript\" src=\"../Misc/script.js\"></script>\\n</head>\\n<body>",
                "(<(p|div|span|a|h\\d)[^>/\n]*?) */>": "\\1></\\2>",
                "alt=\".*?\"": "",
                "\\s+/>": "/>",
                "<b>(.*?)</b>": "<span type=\"check\" class=\"bold\">\\1</span>",
                "<i>(.*?)</i>": "<span type=\"check\" class=\"ita\">\\1</span>",
                "<s>(.*?)</s>": "<span type=\"check\" class=\"del\">\\1</span>",
                "<u>(.*?)</u>": "<span type=\"check\" class=\"un\">\\1</span>",
                "<strong>(.*?)</strong>": "<span type=\"check\" class=\"bolder\">\\1</span>"
            },
            "多余标签清除": {
                "[*]<span[^>/\n]*?xmlns=[^>/\n]*?>((?:(?!</span>).)*?)</span>": "\\1",
                "<span(?:(?!id=)[^>/\n])*?>[\\s　]*</span>": "",
                "<(p|div)(?:(?!id=)[^>/\n])*?>[\\s　]*</\\1>": "<p><br/></p>",
                "\\s*class=\"[\\s　]*\"": "",
                "<a[^>/\n]*?(?:id=\"([^\"\\n]*?)\"[^>/\n]*?href=\"([^\"\\n]*?)\"|href=\"([^\"\\n]*?)\"[^>/\n]*?id=\"([^\"\\n]*?)\")>((?:(?!</a>).)*?)</a>": "<span id=\"\\1\\4\"><a href=\"\\2\\3\">\\5</a></span>",
                "[*](<[A-z\\d]+[^>/\n]*?)\\s*id=\"([^\"\\n]*?)\"([^>/\n]*?>[\\s\\S]*?)<a[^>/\n]*?href=\"[^\"\\n]*?#\\2\\s*\"[^>/\n]*?>((?:(?!</a>).)*?)</a>": "\\1\\3\\4",
                "[*]<div(?:(?!check-|id=)[^>/\n])*?>\\s*((?:[^<>]*?(?:<(?P<tag>[A-z\\d]+)[^>/\n]*?>(?:(?!</(?P=tag)>)[\\s\\S])*</(?P=tag)>|<[^>/\n]*?/>))*[^<>]*)</div>\\s*": "\\1",
                "[*]<span(?:[^>/\n]*?xmlns[^>/\n]*?|(?:(?!check-|id=)[^>/\n])*?)>((?:[^<>]*?(?:<(?P<tag>[A-z\\d]+)[^>/\n]*?>(?:(?!</(?P=tag)>)[\\s\\S])*</(?P=tag)>|<[^>/\n]*?/>))*[^<>]*)</span>": "\\1",
                "[*](<a[^>/\n]*?>(?:(?!</a>).)*?)<span[^>/\n]*?>((?:(?!</span>|</a>).)*?)</span>": "\\1\\2",
                "(?:\\s*<rb>(.*?)</rb>\\s*|\\s*(<rt>.*?</rt>)\\s*|\\s*<rp[^>/\n]*?>.*?</rp>\\s*|<hr[^>/\n]*?/>|<a id=\"section.*?/a>)": "\\1\\2"
            }
        }
    ],
    "文本处理": [
        "(?s)<body.*?/body>",
        {
            "全角转半角": {
                "０": "0",
                "１": "1",
                "２": "2",
                "３": "3",
                "４": "4",
                "５": "5",
                "６": "6",
                "７": "7",
                "８": "8",
                "９": "9",
                "Ａ": "A",
                "Ｂ": "B",
                "Ｃ": "C",
                "Ｄ": "D",
                "Ｅ": "E",
                "Ｆ": "F",
                "Ｇ": "G",
                "Ｈ": "H",
                "Ｉ": "I",
                "Ｊ": "J",
                "Ｋ": "K",
                "Ｌ": "L",
                "Ｍ": "M",
                "Ｎ": "N",
                "Ｏ": "O",
                "Ｐ": "P",
                "Ｑ": "Q",
                "Ｒ": "R",
                "Ｓ": "S",
                "Ｔ": "T",
                "Ｕ": "U",
                "Ｖ": "V",
                "Ｗ": "W",
                "Ｘ": "X",
                "Ｙ": "Y",
                "Ｚ": "Z",
                "ａ": "a",
                "ｂ": "b",
                "ｃ": "c",
                "ｄ": "d",
                "ｅ": "e",
                "ｆ": "f",
                "ｇ": "g",
                "ｈ": "h",
                "ｉ": "i",
                "ｊ": "j",
                "ｋ": "k",
                "ｌ": "l",
                "ｍ": "m",
                "ｎ": "n",
                "ｏ": "o",
                "ｐ": "p",
                "ｑ": "q",
                "ｒ": "r",
                "ｓ": "s",
                "ｔ": "t",
                "ｕ": "u",
                "ｖ": "v",
                "ｗ": "w",
                "ｘ": "x",
                "ｙ": "y",
                "ｚ": "z",
                "＃": "#",
                "＄": "$",
                "％": "%",
                "＊": "*",
                "＋": "+",
                "＠": "@",
                "＝": "=",
                "［": "[",
                "］": "]",
                "｛": "{",
                "｝": "}"
            },
            "符号转换": {
                "\\?\\?": "？？",
                "(?:\\!\\!|‼)": "！！",
                "(?:\\!\\?|⁉)": "！？",
                "﹙": "（",
                "﹚": "）",
                "[︰‥]": "：",
                "[－─｜]": "—",
                "(?:\\.{3}|⋯)": "…",
                "[:：]{3}": "……",
                "[~∼〜]": "～",
                "[‧・．˙･·]": "•",
                "❤": "♥",
                "╳": "×",
                "︽": "《",
                "︾": "》",
                "﹁": "「",
                "﹂": "」",
                "﹃": "『",
                "﹄": "』",
                "(?:＜|︿|&lt;)": "〈",
                "(?:＞|﹀|&gt;)": "〉",
                "&amp;": "＆"
            },
            "标点修正": {
                "(?:\\?？|？\\?)": "？？",
                "(?:\\!！|!\\!)": "！！",
                "(?:\\?！|？\\!)": "？！",
                "(?:\\!？|！\\?)": "！？",
                "(?<=[一-龥あ-ヶー]) *\\? *": "？",
                "(?<=[一-龥あ-ヶー]) *\\! *": "！",
                "(?<=[一-龥あ-ヶー]) *, *": "，",
                "(?<=[一-龥あ-ヶー]) *: *": "：",
                "(?<=[一-龥あ-ヶー]) *; *": "；",
                "(?<=[一-龥あ-ヶー]) *\\. *(?=[一-龥あ-ヶー])": "•",
                "(?<=[A-z]) *　 *(?=[A-z])": " ",
                "(?<=\\d)(?: *• *(?=\\d)|•)": ".",
                "(?<=[\\dA-z]) *— *(?=[\\dA-z])": "-",
                "([△▲▽▼▷▶◁◀☜☚☝☟☞☛↖↑↗←→↙↓↘↕↔ㄅㄆㄇㄈㄉㄊㄋㄌㄍㄎㄏㄐㄑㄒㄓㄔㄕㄖㄗㄘㄙㄚㄛㄜㄝㄞㄟㄠㄡㄢㄣㄤㄥㄦㄧㄨㄩㄪㄫㄬㄭㄮㄯ㄰ㄱㆢㄲㆢㄱㆣㄲㆣㄱㆤㄲㆤㄱㆥㄲㆥㄱㆦㄲㆦ˙ˊˇˋ˙˙]+)": "<span type=\"check\">\\1</span>"
            },
            "排版整理": {
                "([\\s　])*<br/>(?(1)[\\s　]*|[\\s　]+)": "<br/>",
                "(<[^p][^>/\n]*?>[^<\\n]*?)<br/>": "\\1\\n<p><br/></p>",
                "\\s*<div.*?>(\\s*<p><br/></p>)+\\s*</div>": "\\1",
                "<p><br/></p>(\\s*<p><br/></p>){2,}": "<p><br/></p>\\n<p><br/></p>",
                "(?:　 | 　)": "　",
                "<(p|div)( )*(?(2)class=\"([^\"\\n]*?)\")>(　*[^　\\n]+?)(　{3,}.*?</\\1>)": "<\\1 class=\"check-\\2\\3\">\\4</\\1>\\n<\\1 class=\"check-\\2\\3\">\\5",
                " {2,}": " ",
                "[*](<a[^>/\n]*?>(?:(?!</a>)[\\s\\S])*?)　{2,}": "\\1　",
                "(<(?:p|div)[^>/\n]*?>)　{1,2}(?!　)": "\\1",
                "<(p|div)( )*(?(2)class=\"(.*?)\")>　{3,7}(?!　)": "<\\1 class=\"check-center\\2\\3\">",
                "<(p|div)( )*(?(2)class=\"(.*?)\")>　{7,}": "<\\1 class=\"check-right\\2\\3\">",
                "<p( )*(?(1)class=\"(.*?)\")>(?=.*?[—…]{5,})": "<p class=\"check-break\\1\\2\">",
                "[*](?:type=\"check\"\\s*)?(?:(class=\".*?)check-\\s*|style=\".*?\")": "type=\"check\" \\1"
            },
            "行间注处理": {
                "[*](<ruby>(?:(?!</ruby>|<rt).)+)<rt[^>/\n]*?>((?:(?!</rt>).)+)</rt>((?:(?!</ruby>|<rt).)+)<rt[^>/\n]*?>((?:(?!</rt>).)+)": "\\1\\3<rt>\\2\\4",
                "(?:(?<=</rt>)((?:(?!</ruby>).)+)(</ruby>)|<ruby[^>/\n]*?>((?:(?!</ruby>|<rt).)*?)</ruby>)": "\\2<span type=\"check\">\\1\\3</span>",
                "<ruby[^>/\n]*?>((?:(?!</ruby>|<rt).)+)<rt[^>/\n]*?>(?:\\s*(?:•|、)+\\s*)+</rt></ruby>": "<span type=\"check\" class=\"dot\">\\1</span>"
            },
            "分节处理": {
                "(?:<p><br/></p>\\s*|<div[^>/\n]*?>\\s*)*<(p|div)((?:(?!cut)[^>/\n])*?(?:><span[^>/\n]*?)?)>[\\s　\\[(（【〈《｛{「『-]*([\\dA-zΑ-ω-]{1,3}?)[\\s　\\])）】〉》｝}」』.]*(?:</span>)?</\\1>(?(2)(?:\\s*<p><br/></p>|\\s*</div>)*|(?:\\s*<p><br/></p>|\\s*</div>)+)": "<p><br/></p>\\n<p type=\"check\" class=\"cut\">- \\3 -</p>\\n<p><br/></p>",
                "(?:<p><br/></p>\\s*|<div[^>/\n]*?>\\s*)*<(p|div)((?:(?!cut)[^>/\n])*?(?:><span[^>/\n]*?)?)>[\\s　\\[(（【〈《｛{「『-]*([\\dA-zΑ-ω-]{1,3}?)[\\s　.-]+([^\\dA-zΑ-ω-].*?)[\\s　\\])）】〉》｝}」』]*(?:</span>)?</\\1>(?(2)(?:\\s*<p><br/></p>|\\s*</div>)*|(?:\\s*<p><br/></p>|\\s*</div>)+)": "<p><br/></p>\\n<p type=\"check\" class=\"cut\">【\\3 \\4】</p>\\n<p><br/></p>",
                "(?:<p><br/></p>\\s*|<div[^>/\n]*?>\\s*)*<(p|div)(?:(?!cut)[^>/\n])*?(?:><span[^>/\n]*?)?>[\\s　]*([^\\n\\dA-zΑ-ω一-龥あ-ヶー`~～(){},.\\\\/;·！…（）—｛｝［］《》〈〉？：“”【】；‘'，。、『』「」\\[\\]•-]+)[\\s　]*</\\1>(?:\\s*<p><br/></p>)*": "<p><br/></p>\\n<p type=\"check\" class=\"cut\">\\2</p>\\n<p><br/></p>",
                "(?:<p><br/></p>\\s*|<div[^>/\n]*?>\\s*)*<(p|div)((?:(?!cut)[^>/\n])*?(?:><span[^>/\n]*?)?)>[\\s　]*([^\\s\\dA-z一-龥あ-ヶー`~～(){},.\\\\/;·！…（）—｛｝［］《》〈〉？：“”【】；‘'，。、『』「」\\[\\]•-])[\\s　]*([^\\dA-zΑ-ω-].*?)[\\s　]*(?:</span>)?</\\1>(?(2)(?:\\s*<p><br/></p>|\\s*</div>)*|(?:\\s*<p><br/></p>|\\s*</div>)+)": "<p><br/></p>\\n<p type=\"check\" class=\"cut\">\\3 \\4</p>\\n<p><br/></p>"
            },
            "样式回复": {
                "class=\"(\\s)*([^\"\\n]+?)(?(1)\\s*|\\s+)\"": "class=\"\\2\"",
                "\\s*class=\"\\s*\"": ""
            }
        }
    ],
    "章节重构": [
        "",
        {
            "目录整理": {
                "<ctt[^>/\n]*?>[\\s\\S]*<a[^>/\n]*?>\\s*<ch>(?:目录|目錄|目録|目次|CONTENTS|Contents|もくじ|もくろく)(?:页|頁|ページ)?</ch>\\s*</a>\\s*</ctt>\\s*": "",
                "<ctt[^>/\n]*?>[\\s\\S]*<a[^>/\n]*?>\\s*<ch>(?:書封|书封|封面|書名|书名|表纸|表紙|ひょうし)(?:页|頁|ページ)?</p>\\s*</ch>\\s*</ctt>\\s*": "",
                "\\s*<ctt[^>/\n]*?>\\s*<a[^>/\n]*?>\\s*<ch>(?:版權|版权|奥付|おくづけ)(?:页|頁|ページ)?</ch>\\s*</a>[\\s\\S]*</ctt>": "",
                "\\s*<ctt[^>/\n]*?>\\s*<a[^>/\n]*?>\\s*<ch>(?:封底|里表纸|裏表紙|うらびょうし)(?:页|頁|ページ)?</ch>\\s*</a>[\\s\\S]*</ctt>": "",
                "<ch>([\\s　])+(.*?)(?(1)[\\s　]*|[\\s　]+)</ch>": "<ch>\\2</ch>",
                "(<ch>\\S)[\\s　]+(\\S(?:[\\s　]+.*?)?</ch>)": "\\1\\2",
                "[*](<ch>(?:(?!</ch>).)*?\\S)　{2,}(\\S(?:(?!</ch>).)*?</ch>)": "\\1　\\2",
                "(<ch>.*?\\S) ([^\\n\\dA-z].*?</ch>)": "\\1　\\2",
                "(<ch>.*?[一-龥あ-ヶー]) ([A-z\\d].*?</ch>)": "\\1　\\2",
                "(<ch>.*?\\S)(([-～—])+.+\\3+</ch>)": "\\1　\\2"
            },
            "标题拉取": {
                "(<ctt[^>/\n]*?>\\s*<a[^>/\n]*?href=\")(?:[^\"\\n]*/)?(([^\"/#\\n]*?)#[^\"/\\n]*?)(\"[^>/\n]*?>[\\s\\S]*?<ctt[^>/\n]*?>\\s*<a[^>/\n]*?href=\"(?:[^\"\\n]*/)?\\2\"[^>/\n]*?>)": "\\1\\3\\4",
                "(<ctt[^>/\n]*?>\\s*<a[^>/\n]*?)href=\"(?:[^\"\\n]*/)?([^\"/#\\n]*?)\"([^>/\n]*?>[\\s\\S]*?<ctt[^>/\n]*?>\\s*<a[^>/\n]*?href=\"(?:[^\"\\n]*/)?\\2\"[^>/\n]*?>)": "\\1type=\"check\"\\3",
                "[*]^([\\s\\S]*?<ctt[^>/\n]*?>\\s*<a[^>/\n]*?href=\"(?:[^\"\\n]*/)?(.*?)(?:\\+part)?\\.xhtml)[^>/\n]*?>([\\s\\S]*?<ctt[^>/\n]*?>\\s*<a[^>/\n]*?href=\"(?:[^\"\\n]*/)?)\\2\\.xhtml#([^\"\\n]*?)(\"[\\s\\S]*?<page id=\"(.*?)(?:\\+part)?\" href=\"\\2(?:\\+part)?\\.xhtml(?:(?!</page>)[\\s\\S])*?)[^].*?id=\"\\4\".*[$]": "\\1\">\\3\\2+part.xhtml\\5</body>\\n</html>\\n</page>\\n<page id=\"\\6+part\" href=\"\\2+part.xhtml\">\\n<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"no\"?>\\n<!DOCTYPE html>\\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"zh\" xmlns:epub=\"http://www.idpf.org/2007/ops\" xmlns:xml=\"http://www.w3.org/XML/1998/namespace\">\\n<head>\\n<title></title>\\n<link href=\"../Styles/stylesheet.css\" type=\"text/css\" rel=\"stylesheet\"/>\\n<script type=\"text/javascript\" src=\"../Misc/script.js\"></script>\\n</head>\\n<body>",
                "[*](<ctt[^>/\n]*?>\\s*<a[^>/\n]*?href=\"(?:[^\"\\n]*/)?(.*?)\\.xhtml[\\s\\S]*?<ctt[^>/\n]*?>\\s*<a[^>/\n]*?href=\"(?:[^\"\\n]*/)?\\2)\\+part": "\\1_part[#001]",
                "[*](<page id=\"(.*?)\" href=\"(.*?)\\.xhtml\">[\\s\\S]*?<page id=\"\\2)\\+part\" href=\"\\3\\+part": "\\1_part[#001]\" href=\"\\3_part[#001]",
                "[*]<ctt([^>/\n]*?>\\s*<a[^>/\n]*?href=\"(?:[^\"\\n]*/)?(.*?\\.xhtml)[^>/\n]*?>\\s*<ch>([^<>\\n]*?)</ch>[\\s\\S]*?<page.*?href=\"\\2\"(?:(?!<body>)[\\s\\S])*?<title>).*?(</title>(?:(?!<body>)[\\s\\S])*?<body>)": "<div\\1\\3\\4\\n<h7>\\3</h7>",
                "(</?)ctt([^>/\n]*?>)": "\\1div\\2",
                "<title></title>(?:(?!</body>)[^一-龥あ-ヶー])*?\\n[^一-龥あ-ヶー\\n]*(?:後[^一-龥あ-ヶー\\n]*記|后[^一-龥あ-ヶー\\n]*记|後書き|あとがき|后书き)[^一-龥あ-ヶー\\n]*[$]": "<title>後記</title>\\n<link href=\"../Styles/stylesheet.css\" type=\"text/css\" rel=\"stylesheet\"/>\\n<script type=\"text/javascript\" src=\"../Misc/script.js\"></script>\\n</head>\\n<body>\\n<h7>後記</h7>",
                "[*]<title>.+?(</title>(?:(?!<title>)[\\s\\S])*?)<h7>.+?</h7>\\s*((?:(?!<h7>|</p>)[\\s\\S])*?(?:<title>.+?</title>|<nav))": "<title>\\1\\2",
                "[*]<title>(.+?)(</title>(?:(?!<title>)[\\s\\S])*?)<h7>\\1</h7>\\s*((?:(?!<title>)[^一-龥あ-ヶー])*?<title>)(</title>[\\s\\S]*?<body>)": "<title>\\2\\3\\1\\4\\n<h7>\\1</h7>",
                "[*](<title>(.+?)</title>(?:(?!<title>)[\\s\\S])*?<h7>\\2</h7>(?:(?!<h7>)[\\s\\S])*?<title>)(</title>[\\s\\S]*?<title>(.+?)</title>(?:(?!<title>)[\\s\\S])*?<h7>\\4</h7>)": "\\1\\2\\3",
                "<ch>(.+?)　+(.*?)</ch>": "<p>\\1</p><p class=\"ctit\">\\2</p>",
                "<ch>(.+?)</ch>": "<p>\\1</p>"
            },
            "标题去重": {
                "(?<=</h7>)(?:(?!</body>|class=)[^一-龥あ-ヶー])*\\n(.+)[$]": "\\n<chapter>\\1</chapter>\\1",
                "(<h7>(\\S+?)(?:[-.•][ 　]+|[ 　]*)(.*?)</h7>\\s*<chapter>.*?</chapter>.*[$](?:(?!</body>)[\\s\\S])*?)[^](.*?\\2.*?\\3.*)[$]": "\\1<chapter>\\4</chapter>\\4",
                "[*](?<=<chapter>)(.*?)(?:<(?:(?!rt)[^>/\n])*?>|<rt(?:(?!/rt>).)+/rt>)(.*?)(?=</chapter>)": "\\1\\2",
                "(<h7>(\\S+?)(?:[-.•][ 　]+|[ 　]*)(.*?))</h7>(?:(?!</body>)[\\s\\S])*?<chapter>[^一-龥あ-ヶー\\n]*\\2[^一-龥あ-ヶー\\n]*\\3[^一-龥あ-ヶー\\n]*</chapter>.*?(<a.*?/a>)?.*[$]": "\\1\\4</h7>",
                "(<page id=\"(.*?_part)(\\d+)(\\.[A-z]+)\">((?:(?!<body>)[\\s\\S])*?<body>)(?:(?!<page)[\\s\\S])*?)(<page(?:(?!</body>)[\\s\\S])*?<h7>(\\S+?)[ 　]*(.*?)</h7>)\\n<chapter>.*?</chapter>((?:(?!</body>)[\\s\\S])*?)<chapter>[^一-龥あ-ヶー\\n]*\\7[^一-龥あ-ヶー\\n]*\\8[^一-龥あ-ヶー\\n]*</chapter>.*[$]": "\\1<page id=\"\\2\">" ''.join((x.group(1), '<page id=\"', x.group(2), str(int(x.group(3))+1).zfill(3), '\" href=\"', x.group(4), str(int(x.group(5))+1).zfill(3), '.xhtml\">', x.group(6), '\\n', x.group(10), '</body>\\n</html>\\n</page>', x.group(7))),"(<page id=\"((?:(?!_part).)*?)\" href=\"((?:(?!_part).)*?)\\.xhtml\">((?:(?!</body>)[\\s\\S])*?<body>)(?:(?!<page)[\\s\\S])*?)(<page(?:(?!</body>)[\\s\\S])*?<h7>(\\S+?)[ 　]*(.*?)</h7>)\\n<chapter>.*?</chapter>((?:(?!</body>)[\\s\\S])*?)<chapter>[^一-龥あ-ヶー\\n]*\\6[^一-龥あ-ヶー\\n]*\\7[^一-龥あ-ヶー\\n]*</chapter>.*[$]": "\\1<page id=\"\\2_part001\" href=\"\\3_part001.xhtml\">\\4\\n\\8</body>\\n</html>\\n</page>\\5",
                "<chapter>.*?</chapter>": ""
            },
            "标题样式": {
                "(<h7>.*</h7>)(?:\\s*<p.*?><br/></p>|\\s*<([A-z]+)[^>/\n]*?>[\\s　]*?</\\2>|\\s*</(?:(?!body)[A-z])+>)+": "\\1",
                "(<h7>.*</h7>)((?:(?!</body>)[^一-龥あ-ヶー])*?</body>)": "<div class=\"chapter\">\\n\\1\\n</div>\\2",
                "<h7>(.*?\\S)　(\\S.*?)</h7>": "<h4>\\1</h4>\\n<h5>\\2</h5>",
                "<(h\\d)>(.*?)\\s*(（[^註注\\n]*）)</\\1>": "<\\1>\\2<span type=\"check\" class=\"em08\">\\3</span></\\1>",
                "<h7>(.*)</h7>": "<h3>\\1</h3>"
            }
        }
    ],
    "注释生成": [
        "",
        {
            "行内注释": {
                "[*]([\\s　]*<span[^>/\\n]*?>)?[\\s　]*（([\\s　]*<span[^>/\\n]*?>)?[※﹡*\\s　]*[譯译編编]?[註注][\\s　]*\\d*[\\s　：]+((?:[^（）\\n]*?（(?:(?!）).)*）)*[^（）\\n]+)(?(2)</span>[\\s　]*)）[\\s　]*(?(1)</span>[\\s　]*)(.*(?:\\s*<aside>.*?</aside>)*)": "<sup/>\\4\\n<aside>\\3</aside>",
                "[*](</[A-z\\d]+>\\s*)[^]<[A-z\\d]+[^>/\n]*?>([^一-龥あ-ヶー\\n]*<sup/>)[^一-龥あ-ヶー\\n]*[$]": "\\2\\1"
            },
            "页尾注释": {
                "[*](?:[\\s　]*<(span|sup)[^>/\n]*?>)?[\\s　]*(?:<a[^>/\n]*?href=\"[^\"\\n]*?#([^\"\\n]*?)\\s*\"[^>/\n]*?>[\\s　]*)?（(?:[\\s　]*<a[^>/\n]*?href=\"[^\"\\n]*?#([^\"\\n]*?)\\s*\"[^>/\n]*?>)?[※﹡*\\s　]*[譯译編编]?[註注](?:[\\s　]*<a[^>/\n]*?href=\"[^\"\\n]*?#([^\"\\n]*?)\\s*\"[^>/\n]*?>)?[\\s　]*\\d*[\\s　]*(?:</a>[\\s　]*)?）[\\s　]*(?:</a>[\\s　]*)?(?(1)</\\1>[\\s　]*)(.*(?:\\s*<aside>.*?</aside>)*)([\\s\\S]*?)[^](.*?<([A-z\\d]+)[^>/\n]*?id=\"\\s*(?:\\2|\\3|\\4)\\s*\"[^>/\n]*?>(?:[^<>]*?(?:<(?P<tag>[A-z\\d]+)[^>/\n]*?>(?:(?!</(?P=tag)>)[\\s\\S])*</(?P=tag)>|<[^>/\n]*?/>))*[^<>]*</\\8>.*)[$]": "<sup/>\\5\\n<aside>\\7</aside>\\6\\7",
                "(?s)(<aside>((?:(?!</aside>).)*?)</aside>.*?)(?<!<aside>)\\2(?!</aside>).*?(?=</body>)": "\\1",
                "(?s)<((?:(?!body)[A-z\\d])+)( )*(?(2)[^>/\n]*?[^>/\\n])>(?:(?!</\\1>|</?body).)*(?=</body>)": ""
            },
            "弹注样式": {
                "[^](.*?<sup/>.*(?:\\s*<aside>(?:(?!</aside>)[\\s\\S])*?</aside>)*)": "<note>\\n\\1\\n</note>",
                "[*](<aside>.*?)<ruby>((?:(?!</ruby>|<rt).)*?)<rt>(.*?)</rt></ruby>": "\\1\\2（\\3）",
                "[*](<aside>(?:(?!</aside>).)*?)\\s*(?:<(?:(?!ruby|rt|aside)[^>/\n])*?>|\\n)+\\s*": "\\1",
                "<aside>[※﹡*\\s　]*([譯译編编]?[註注])[\\s　]*(\\d*)[\\s　：]*(.*?</aside>)": "<aside>\\1\\2：\\3",
                "<aside>((?:(?!：).)*</aside>)": "<aside>註：\\1"
            },
            "弹注生成": {
                "[*]^([\\s\\S]*?)<sup/>([\\s\\S]*?)<aside>(.*?)(?=</aside>)": "\\1<sup type=\"check\"><a class=\"duokan-footnote\" epub:type=\"noteref\" href=\"#note[#001]\" id=\"note_ref[#001]\"><img alt=\"note\" class=\"zhangyue-footnote\" src=\"../Images/note.png\" zy-footnote=\"\\3\"/></a></sup>\\2<aside epub:type=\"footnote\" id=\"note[#001]\">\\n<a href=\"#note_ref[#001]\">\\n<ol class=\"duokan-footnote-content\">\\n<li class=\"duokan-footnote-item\" id=\"note[#001]\" value=\"[#001]\">\\n<p>\\3</p>\\n</li>\\n</ol>\\n</a>\\n"
            }
        }
    ],
    "图片版式": [
        "(?s)<page.*?/page>",
        {
            "SVG处理": {
                "(?:<p.*?><br/></p>\\s*|<div.*?>\\s*)*<svg.*?>(?:(?!</svg>)[\\s\\S])*?<image[^>/\n]*?href=\"[^\"\\n]*/cover\\.(jpe?g|webp)\"/>(?:(?!</svg>)[\\s\\S])*?</svg>(?:\\s*<p.*?><br/></p>|\\s*</div>)*": "<div class=\"cover duokan-image-single\">\\n<img alt=\"cover\" src=\"../Images/cover.\\1\" zy-enlarge-src=\"self\"/>\\n</div>",
                "(?:<p.*?><br/></p>\\s*|<div.*?>\\s*)*<svg.*?>(?:(?!</svg>)[\\s\\S])*?<image[^>/\n]*?href=\"[^\"\\n]*/([^\"/\\n]*?)\\.(jpe?g|png|webp)\"[^>/\n]*?/>(?:(?!</svg>)[\\s\\S])*?</svg>(?:\\s*<p.*?><br/></p>|\\s*</div>)*": "<div class=\"kuchie duokan-image-single\">\\n<img alt=\"\\1\" src=\"../Images/\\1.\\2\" zy-enlarge-src=\"self\"/>\\n</div>"
            },
            "IMG处理": {
                "(?:<p.*?><br/></p>\\s*|<div.*?>\\s*)*[^][^一-龥あ-ヶー\\n]*<img[^>/\n]*?src=\"[^\"\\n]*/([^\"/\\n]*?)\\.(jpe?g|webp)\"(?:(?!zy-enlarge-src)[^>/\n])*?>[^一-龥あ-ヶー\\n]*[$](?:\\s*<p.*?><br/></p>|\\s*</div>)*": "<div class=\"illus duokan-image-single\">\\n<img alt=\"\\1\" src=\"../Images/\\1.\\2\" zy-enlarge-src=\"self\"/>\\n</div>",
                "(?:<p.*?><br/></p>\\s*|<div.*?>\\s*)*[^][^一-龥あ-ヶー\\n]*<img[^>/\n]*?src=\"[^\"\\n]*/((?:(?!logo|note)[^\"/\\n])*?)\\.png\"(?:(?!zy-enlarge-src)[^>/\n])*?>[^一-龥あ-ヶー\\n]*[$](?:\\s*<p.*?><br/></p>|\\s*</div>)*": "<p type=\"check\" class=\"cut\"><img alt=\"\\1\" src=\"../Images/\\1.png\" zy-enlarge-src=\"none\"/></p>"
            },
            "图片样式修正": {
                "(?:<p.*?><br/></p>\\s*|<div.*?>\\s*)*\\s*<(?:image|img)[^>/\n]*?(?:href|src)=\"[^\"\\n]*/((?:(?!logo|note|cover)[^\"/\\n])*?)\\.([A-z\\d]+)\"(?:(?!zy-enlarge-src)[^>/\n])*?>\\s*(?:\\s*<p.*?><br/></p>|\\s*</div>)*": "<img alt=\"\\1\" src=\"../Images/\\1.\\2\"/>",
                "(?<=<body>)(?:(?!<img)[^一-龥あ-ヶー])*[^](?:(?!cover duokan).)*[$]\\s*(<img[^>/\n]*?src=\"cover.jpe?g\")[^>/\n]*?>(?:(?!<img)[^一-龥あ-ヶー])*(?=</body>)": "\\n<div class=\"cover duokan-image-single\">\\n\\1 zy-enlarge-src=\"self\"/>\\n</div>\\n",
                "^((?:(?!cover)[\\s\\S])*?<page.*?href=\".*?cover(?:(?!</body>)[\\s\\S])*?<body>)(?:(?!<img|</body>|cover duokan)[^一-龥あ-ヶー])*(<img[^>/\n]*?src=\".*?\")[^>/\n]*?>(?:(?!<img|</body>|cover duokan)[^一-龥あ-ヶー])*(?=</body>)": "\\1\\n<div class=\"cover duokan-image-single\">\\n\\2 zy-enlarge-src=\"self\"/>\\n</div>\\n",
                "(?<=<body>)(?:(?!<img)[^一-龥あ-ヶー])*[^](?:(?!kuchie duokan|cover duokan).)*[$]\\s*(<img[^>/\n]*?src=\".*?\")[^>/\n]*?>(?:(?!<img)[^一-龥あ-ヶー])*(?=</body>)": "\\n<div class=\"kuchie duokan-image-single\">\\n\\1 zy-enlarge-src=\"self\"/>\\n</div>\\n"
            }
        }
    ],
    "页面复查": [
        "(?s)<page.*?/page>",
        {
            "TITLE填充": {
                "<title>.*?(</title>[\\s\\S]*?<div[^>/\n]*?cover duokan)": "<title>封面\\1",
                "<title>.*?(</title>[\\s\\S]*?<div[^>/\n]*?kuchie duokan)": "<title>插圖\\1"
            },
            "页面检查": {
                "(?<=<ruby>)(.*?)(<rt>(?:(?!</ruby>|<rt>).)*?</rt>)": "<rb>\\1</rb><rp>（</rp>\\2<rp>）</rp>",
                "[*](<body>(?:(?!<div)[\\s\\S])*?)\\s*</div>": "\\1",
                "[*](<body>(?:(?!<p)[\\s\\S])*?)\\s*</p>": "\\1",
                "[*](<body>\\s*(<div.*?>)?(?:[^<>]*?(?:<(?P<tag>[A-z\\d]+)[^>/\n]*?>(?:(?!</(?P=tag)>)[\\s\\S])*</(?P=tag)>|<[^>/\n]*?/>))*[^<>]*)</[A-z\\d]+>((?(2)\\s*</div>)\\s*</body>)": "\\1\\3",
                "(?<=<body>\\n)(\\s*<p.*?><br/></p>|\\s*<([A-z]+)[^>/\n]*?>[\\s　]*?</\\2>|\\s)+": "",
                "(?:\\s*<p.*?><br/></p>)*\\s*(?=\\n</body>)": "",
                "(?<=<body>)\\s*(?=<p)": "\\n<p><br/></p>\\n",
                "(?<=href=\")([^\"\\n]+)#[^\"\\n]*?(?=\")": "\\1",
                "[*](<page.*?href=\"(.*?)\"[\\s\\S]*?href=\")(?=#)": "\\1\\2",
                "(<[A-z\\d]+)((?:(?!type=\"check\")[^>/\n])*?>[^\\n\\dA-zΑ-ω一-龥あ-ヶー`~～\\[\\](){},.\\\\/;·！…（）—｛｝［］《》〈〉？：“”【】；‘'，。、『』「」<>]+)": "\\1 type=\"check\"\\2",
                "(<[A-z\\d]+)(((?:(?!type=\"check\")[^>/\n])*?>[^<>\\n]*?)[1①ⅰⅠiI一壹壱](?:(?!href=)[\\s\\S])*?\\1\\3(?:[2②ⅱⅡ二贰貳弐]|[iI]{2})": "\\1 type=\"check\"\\2"
            }
        }
    ]
}